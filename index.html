<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Beyond the Frame: Generating 360° Panoramic Videos from Perspective Videos</title>
  <!-- Include Video Panorama library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/panolens@0.12.1/build/panolens.min.js"></script>
  <style>
    .video-wrapper {
      position: relative;
      width: 100%;
      border-radius: 8px;
      overflow: hidden;
    }

    #regularVideo {
      width: 100%;
      display: block;
      cursor: pointer;
    }

    .viser-demo {
      width: 80%;
      height: 500px;
      margin: 0 auto;
      box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);
    }

    .play-360-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.3);
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
      /* This makes the overlay non-interactive */
    }

    .video-wrapper:hover .play-360-overlay {
      opacity: 1;
    }

    .play-360-button {
      background-color: rgba(255, 255, 255, 0.8);
      color: #000;
      border: none;
      border-radius: 50px;
      padding: 12px 24px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      pointer-events: auto;
      /* This makes the button interactive again */
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }

    .play-360-button svg {
      width: 24px;
      height: 24px;
    }

    /* 360 video modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #000;
      z-index: 1000;
    }

    #video360Container {
      width: 100%;
      height: 100%;
    }

    /* Loading indicator */
    .loader {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 50px;
      height: 50px;
      border: 5px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
      z-index: 1001;
    }

    @keyframes spin {
      to {
        transform: translate(-50%, -50%) rotate(360deg);
      }
    }

    /* Close button */
    .close-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      color: white;
      font-size: 30px;
      font-weight: bold;
      z-index: 1001;
      cursor: pointer;
      background-color: rgba(0, 0, 0, 0.5);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .close-btn:hover {
      background-color: rgba(255, 0, 0, 0.7);
    }

    .video-title {
      text-align: center;
      margin-bottom: 15px;
      font-size: 24px;
    }

    .instructions {
      text-align: center;
      margin: 15px auto;
      color: #666;
      max-width: 600px;
    }

    /* Controls for 360 video */
    .video-controls {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 15px;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 10px 15px;
      border-radius: 30px;
      z-index: 1001;
    }

    .control-btn {
      background: none;
      border: none;
      color: white;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 5px 10px;
    }

    .control-btn:hover {
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 5px;
    }

    /* Debug panel */
    #debugPanel {
      position: fixed;
      bottom: 10px;
      left: 10px;
      background-color: rgba(0, 0, 0, 0.7);
      color: #fff;
      padding: 10px;
      border-radius: 5px;
      font-family: monospace;
      font-size: 12px;
      max-width: 300px;
      z-index: 1002;
      display: none;
    }
  </style>
</head>

<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="Beyond the Frame: Generating 360° Panoramic Videos from Perspective Video">
  <meta property="og:title" content="Beyond the Frame: Generating 360° Panoramic Videos from Perspective Videos" />
  <meta property="og:description"
    content="Beyond the Frame: Generating 360° Panoramic Videos from Perspective Videos" />
  <meta property="og:url" content="./index.html" />
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/banner.jpg" />
  <meta property="og:image:width" content="2012" />
  <meta property="og:image:height" content="1462" />


  <meta name="twitter:title" content="Beyond the Frame: Generating 360° Panoramic Videos from Perspective Video">
  <meta name="twitter:description" content="Beyond the Frame: Generating 360° Panoramic Videos from Perspective Video">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/banner.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="360° Panoramic Video Generation">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Beyond the Frame: Generating 360° Panoramic Videos from Perspective Videos</title>
  <link rel="icon" type="image/x-icon" href="static/images/Argus.jpg">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-RPBN0TMGB1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RPBN0TMGB1');
</script>

<body>
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Beyond the Frame: Generating 360° Panoramic Videos from Perspective
              Videos</h1>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Teaser video-->
  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <div class="item item-video1">
          <h2 class="subtitle has-text-centered" style="margin-bottom: -0.5px;">
            <strong><span style="color: rgb(227, 44, 94);">Note: </span>Hover over the video to view in 360°.</strong>
          </h2>
          <div id="results-carousel" class="carousel results-carousel">
            <div class="item video-wrapper">
              <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/long-term-generation/2.mp4" type="video/mp4">
              </video>
              <div class="play-360-overlay">
                <button class="play-360-button">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polygon points="10 8 16 12 10 16"></polygon>
                  </svg>
                  View in 360°
                </button>
              </div>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-two-third">
                    <p>Generated 360° Panorama</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item video-wrapper">
              <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/long-term-generation/3.mp4" type="video/mp4">
              </video>
              <div class="play-360-overlay">
                <button class="play-360-button">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polygon points="10 8 16 12 10 16"></polygon>
                  </svg>
                  View in 360°
                </button>
              </div>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-two-third">
                    <p>Generated 360° Panorama</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item video-wrapper">
              <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/long-term-generation/4.mp4" type="video/mp4">
              </video>
              <div class="play-360-overlay">
                <button class="play-360-button">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polygon points="10 8 16 12 10 16"></polygon>
                  </svg>
                  View in 360°
                </button>
              </div>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-two-third">
                    <p>Generated 360° Panorama</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item video-wrapper">
              <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/long-term-generation/8.mp4" type="video/mp4">
              </video>
              <div class="play-360-overlay">
                <button class="play-360-button">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polygon points="10 8 16 12 10 16"></polygon>
                  </svg>
                  View in 360°
                </button>
              </div>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-two-third">
                    <p>Generated 360° Panorama</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item video-wrapper">
              <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/long-term-generation/1.mp4" type="video/mp4">
              </video>
              <div class="play-360-overlay">
                <button class="play-360-button">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polygon points="10 8 16 12 10 16"></polygon>
                  </svg>
                  View in 360°
                </button>
              </div>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-two-third">
                    <p>Generated 360° Panorama</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item video-wrapper">
              <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/long-term-generation/5.mp4" type="video/mp4">
              </video>
              <div class="play-360-overlay">
                <button class="play-360-button">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polygon points="10 8 16 12 10 16"></polygon>
                  </svg>
                  View in 360°
                </button>
              </div>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-two-third">
                    <p>Generated 360° Panorama</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item video-wrapper">
              <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/long-term-generation/6.mp4" type="video/mp4">
              </video>
              <div class="play-360-overlay">
                <button class="play-360-button">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polygon points="10 8 16 12 10 16"></polygon>
                  </svg>
                  View in 360°
                </button>
              </div>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-two-third">
                    <p>Generated 360° Panorama</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item video-wrapper">
              <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/long-term-generation/7.mp4" type="video/mp4">
              </video>
              <div class="play-360-overlay">
                <button class="play-360-button">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polygon points="10 8 16 12 10 16"></polygon>
                  </svg>
                  View in 360°
                </button>
              </div>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-two-third">
                    <p>Generated 360° Panorama</p>
                  </div>
                </div>
              </h2>
            </div>
          </div>
        </div>
        <h2 class="subtitle has-text-centered">
          <p>
            <strong>360° videos generated by our model, Argus<sup>*</sup>. </strong> Starting from an arbitrary input
            perspective video capturing everyday activities (left),
            Argus generates a full 360° panoramic video, with the <span style="color: rgb(227, 44, 94);">red</span> box
            indicating the corresponding region in the generated frame.
          </p>
        </h2>
        <div class="columns">
          <p style="font-size: 12px;">
            <sup>*</sup>Argus is named after a figure in Greek mythology with many eyes, symbolizing the ability to
            observe from multiple perspectives.
          </p>
        </div>
      </div>
    </div>
  </section>

  <section class="section hero is-light">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column">
          <h2 class="title is-3">Visualization in Perspective Views</h2>
        </div>
      </div>
      <div class="container" style="width: 100%;">
        <div id="results-carousel" class="carousel results-carousel">
          <div class="item video-wrapper">
            <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/teaser/streamline-1.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item video-wrapper">
            <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/teaser/streamline-3.mp4" type="video/mp4">
            </video>
          </div>
          <div class="item video-wrapper">
            <video id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/teaser/streamline-2.mp4" type="video/mp4">
            </video>
          </div>
        </div>
      </div>
      <div style="width: 100%; margin: auto;">
        <p>Starting from an input perspective
          video with arbitrary camera motion (<span style="color: rgb(227, 44, 94);">red</span> boxes),
          Argus generates a full 360° panoramic video (visualized as environment maps), with the <span
            style="color: rgb(227, 44, 94);">red</span> box indicating the corresponding region in the generated
          frame. The <span style="color: rgb(69, 144, 201);">blue</span>, <span style="color: #d6970e;">orange</span>,
          and <span style="color: rgb(153, 102, 204);">purple</span> boxes show
          additional sampled perspectives from the generated 360° video.
        </p>
      </div>
    </div>
  </section>

  <!-- Paper abstract -->
  <section class="section hero">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              360° videos have emerged as a promising medium to represent our dynamic visual world. Compared to
              the "tunnel vision" of standard cameras, their borderless field of view offers a more holistic
              perspective of our surroundings. However, while existing video models excel at producing standard
              videos, their ability to generate full panoramic videos remains elusive.
              In this paper, we investigate the task of video-to-360° generation: given a perspective video as
              input, our goal is to generate a full panoramic video that is coherent with the input.
              Unlike conventional video generation tasks, the output's field of view is significantly larger, and the
              model is required to have a deep understanding of both the spatial layout of the scene and the dynamics
              of objects to maintain geometric and dynamic consistency with the input.
              To address these challenges, we first leverage the abundant 360° videos available online and
              develop a high-quality data filtering pipeline to curate pairwise training data.
              We then carefully design a series of geometry- and motion-aware modules to facilitate the learning
              process and improve the quality of 360° video generation.
              Experimental results demonstrate that our model can generate realistic and coherent 360° videos
              from arbitrary, in-the-wild perspective inputs. Additionally, we showcase its potential applications,
              including video stabilization, camera viewpoint control, and interactive visual question answering.
            </p>
          </div>
        </div>
      </div>
  </section>
  <!-- End paper abstract -->

  <section class="hero is-small is-light">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Analysis: Interpreting Scene Dynamics</h2>
        <div style="width: 95%; margin: auto;">
          <p>We demonstrate Argus accurately understands dynamics across the 360° scene from a narrow perspective input.
            Using a 360° camera, we captured a video of a car driving by while providing our model with a 60°
            horizontal FoV region from a static camera pose (left). The car's ground truth trajectory (middle)
            and our model's predicted trajectory (right) show strong alignment, confirming Argus's ability to
            accurately interpret scene dynamics. <strong>Note: if the videos do not play, click either of the three
              videos will trigger them simultaneously.</strong>
          </p>
        </div>
        <div style="width: 95%; margin: auto;">
          <br>
          <div class="columns">
            <div class="column is-one-third">
              <video poster="" id="estimation1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/dynamic-estimation/input.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <p>Input Video</p>
              </h2>
            </div>
            <div class="column is-one-third">
              <video poster="" id="estimation2" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/dynamic-estimation/gt_detect.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <p>Ground truth trajectory</p>
              </h2>
            </div>
            <div class="column is-one-third">
              <video poster="" id="estimation3" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/dynamic-estimation/ours_detect.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <p>Predicted trajectory (ours)</p>
              </h2>
            </div>
          </div>
        </div>
      </div>
  </section>

  <section class="hero is-small">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Analysis: Reconstructing the Scene from Generated Videos</h2>
        <div style="width: 95%; margin: auto;">
          <p>
            We unwrap a rotating perspective video from our generated 360° video and show the scene reconstructed from
            it using MegaSaM. As shown, the reconstruction is geometrically consistent, justifying our generated
            360° video achieves high realism.
          </p>
        </div>
        <br>
        <h2 class="subtitle has-text-centered" style="margin-bottom: -5px;"><strong>Click the image to view
            interactive results</strong></h2>
        <br>
        <a href="https://red-fairy.github.io/argus/index_megasam.html">
          <div class="container" style="width: 80%;">
            <div class="item viser-demo">
              <div style="display: flex; justify-content: center;">
                <img src="static/viser/0003.png" alt="MegaSaM Reconstruction" style="width: 100%; height: 100%;">
              </div>
            </div>
          </div>
        </a>
      </div>
    </div>
  </section>

  <section class="hero is-small is-light">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Analysis: Using Generated Videos as Input</h2>
        <div style="width: 95%; margin: auto;">
          <p>
            We test Argus on perspective videos generated by the text-to-video model Gen-3-Turbo with prompt "Central
            Park." As shown, Argus generalizes to generated videos.
          </p>
        </div>
        <br>
        <div style="width: 95%; margin: auto;">
          <div style="width: 80%; margin: auto;">
            <video poster="" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/generated-input/generated_stack.mp4" type="video/mp4">
            </video>
            <h2 class="subtitle has-text-centered">
              <div class="columns">
                <div class="column is-two-fifth">
                  <p>Input
                    video&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  </p>
                </div>
                <div class="column is-three-fifth">
                  <p>360° video generated by Argus&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  </p>
                </div>
              </div>
            </h2>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero is-small is-light">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Camparison with PanoDiffusion (Image-to-360° Generation)</h2>
        <div style="width: 95%; margin: auto;">
          <p><strong>Qualitative comparison with 360° image generation method PanoDiffusion [1].</strong> The input
            region
            is highlighted in <span style="color: rgb(227, 44, 94);">red</span>, while <span
              style="color: #d6970e;">orange</span> and <span style="color: rgb(69, 144, 201);">blue</span> regions
            indicate extracted perspective views. Although PanoDiffusion can generate plausible 360° images from
            perspective inputs, it struggles with maintaining temporal consistency.</p>
          <br>
          <p style="font-size: 12px;">
            [1] Wu et al. <i>PanoDiffusion: 360-degree Panorama Outpainting via Diffusion</i>. In ICLR, 2024.
          </p>
        </div>
        <div id="results-carousel" class="carousel results-carousel">
          <div class="item item-video1">
            <video poster="" id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/comparison-panodiffusion/1.mp4" type="video/mp4">
            </video>
            <h2 class="subtitle has-text-centered">
              <div class="columns">
                <div class="column is-one-fifth">
                  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Input Video</p>
                </div>
                <div class="column is-two-fifth">
                  <p>&nbsp;&nbsp;&nbsp;Argus (ours)</p>
                </div>
                <div class="column is-two-fifth">
                  <p>PanoDiffusion</p>
                </div>
              </div>
            </h2>
          </div>
          <div class="item item-video2">
            <video poster="" id="video2" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/comparison-panodiffusion/2.mp4" type="video/mp4">
            </video>
            <h2 class="subtitle has-text-centered">
              <div class="columns">
                <div class="column is-one-fifth">
                  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Input Video</p>
                </div>
                <div class="column is-two-fifth">
                  <p>&nbsp;&nbsp;&nbsp;Argus (ours)</p>
                </div>
                <div class="column is-two-fifth">
                  <p>PanoDiffusion</p>
                </div>
              </div>
            </h2>
          </div>
          <div class="item item-video3">
            <video poster="" id="video3" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/comparison-panodiffusion/3.mp4" type="video/mp4">
            </video>
            <h2 class="subtitle has-text-centered">
              <div class="columns">
                <div class="column is-one-fifth">
                  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Input Video</p>
                </div>
                <div class="column is-two-fifth">
                  <p>&nbsp;&nbsp;&nbsp;Argus (ours)</p>
                </div>
                <div class="column is-two-fifth">
                  <p>PanoDiffusion</p>
                </div>
              </div>
            </h2>
          </div>
          <div class="item item-video4">
            <video poster="" id="video4" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/comparison-panodiffusion/4.mp4" type="video/mp4">
            </video>
            <h2 class="subtitle has-text-centered">
              <div class="columns">
                <div class="column is-one-fifth">
                  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Input Video</p>
                </div>
                <div class="column is-two-fifth">
                  <p>&nbsp;&nbsp;&nbsp;Argus (ours)</p>
                </div>
                <div class="column is-two-fifth">
                  <p>PanoDiffusion</p>
                </div>
              </div>
            </h2>
          </div>
          <div class="item item-video5">
            <video poster="" id="video5" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/comparison-panodiffusion/5.mp4" type="video/mp4">
            </video>
            <h2 class="subtitle has-text-centered">
              <div class="columns">
                <div class="column is-one-fifth">
                  <p>Input Video</p>
                </div>
                <div class="column is-two-fifth">
                  <p>Argus (ours)</p>
                </div>
                <div class="column is-two-fifth">
                  <p>PanoDiffusion</p>
                </div>
              </div>
            </h2>
          </div>
          <div class="item item-video6">
            <video poster="" id="video6" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/comparison-panodiffusion/6.mp4" type="video/mp4">
            </video>
            <h2 class="subtitle has-text-centered">
              <div class="columns">
                <div class="column is-one-fifth">
                  <p>Input Video</p>
                </div>
                <div class="column is-two-fifth">
                  <p>Argus (ours)</p>
                </div>
                <div class="column is-two-fifth">
                  <p>PanoDiffusion</p>
                </div>
              </div>
            </h2>
          </div>
          <div class="item item-video7">
            <video poster="" id="video7" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/comparison-panodiffusion/7.mp4" type="video/mp4">
            </video>
            <h2 class="subtitle has-text-centered">
              <div class="columns">
                <div class="column is-one-fifth">
                  <p>Input Video</p>
                </div>
                <div class="column is-two-fifth">
                  <p>Argus (ours)</p>
                </div>
                <div class="column is-two-fifth">
                  <p>PanoDiffusion</p>
                </div>
              </div>
            </h2>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero is-small">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Camparison with Follow-Your-Canvas (Video Outpainting)</h2>
        <div style="width: 95%; margin: auto;">
          <p><strong>Qualitative comparison with Follow-Your-Canvas [2] for 360° video generation.</strong>
            Videos generated by Follow-Your-Canvas look like normal perspective videos, and its generation quality
            declines noticeably as it extends further from the input viewpoint.
          </p>
          <br>
          <p style="font-size: 12px;">
            [2] Chen et al. <i>Follow-Your-Canvas: Higher-Resolution Video Outpainting with Extensive Content
              Generation</i>.
            In AAAI, 2025.
          </p>
        </div>
        <div class="container" style="width: 90%;">
          <div id="results-carousel" class="carousel results-carousel">
            <div class="item item-video1">
              <video poster="" id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/comparison-video-outpainting/120-stack-1.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-second">
                    <p>Argus (ours)</p>
                  </div>
                  <div class="column is-one-second">
                    <p>Follow-Your-Canvas</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video2">
              <video poster="" id="video2" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/comparison-video-outpainting/120-stack-2.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-second">
                    <p>Argus (ours)</p>
                  </div>
                  <div class="column is-one-second">
                    <p>Follow-Your-Canvas</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video3">
              <video poster="" id="video3" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/comparison-video-outpainting/90-stack-1.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-second">
                    <p>Argus (ours)</p>
                  </div>
                  <div class="column is-one-second">
                    <p>Follow-Your-Canvas</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video4">
              <video poster="" id="video4" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/comparison-video-outpainting/90-stack-2.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-second">
                    <p>Argus (ours)</p>
                  </div>
                  <div class="column is-one-second">
                    <p>Follow-Your-Canvas</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video5">
              <video poster="" id="video5" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/comparison-video-outpainting/60-stack-1.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-second">
                    <p>Argus (ours)</p>
                  </div>
                  <div class="column is-one-second">
                    <p>Follow-Your-Canvas</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video6">
              <video poster="" id="video6" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/comparison-video-outpainting/60-stack-2.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-second">
                    <p>Argus (ours)</p>
                  </div>
                  <div class="column is-one-second">
                    <p>Follow-Your-Canvas</p>
                  </div>
                </div>
              </h2>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Stabilizaiton -->
  <section class="hero is-small">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Application: Video Stabilization</h2>
        <div style="width: 95%; margin: auto;">
          Argus shows promising application in video stabilization without modifications.
          Traditional video stabilization techniques require cropping, leading to a reduced field of view and visual
          information loss. In contrast, Argus enables video stabilization with a consistent field of view, as the
          generated panorama preserves scene information across frames.
        </div>
        <div style="width: 95%; margin: auto;">
          <div id="results-carousel" class="carousel results-carousel">
            <div class="item item-video1">
              <video poster="" id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/stabilization/3.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (Argus)</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (reference)</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video2">
              <video poster="" id="video2" autoplay controls muted loop loading="lazy" preload="metadata">
                <!-- Your video file here -->
                <source src="static/videos/stabilization/10.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (Argus)</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (reference)</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video3">
              <video poster="" id="video3" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/stabilization/16.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (Argus)</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (reference)</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video4">
              <video poster="" id="video4" autoplay controls muted loop loading="lazy" preload="metadata">
                <!-- Your video file here -->
                <source src="static/videos/stabilization/2.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (Argus)</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (reference)</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video5">
              <video poster="" id="video5" autoplay controls muted loop loading="lazy" preload="metadata">
                <!-- Your video file here -->
                <source src="static/videos/stabilization/12.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (Argus)</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (reference)</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video6">
              <video poster="" id="video6" autoplay controls muted loop loading="lazy" preload="metadata">
                <!-- Your video file here -->
                <source src="static/videos/stabilization/13.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (Argus)</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Stabilization (reference)</p>
                  </div>
                </div>
              </h2>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Tracking -->
  <section class="hero is-small is-light">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Application: Camera View Direction Control</h2>
        <div style="width: 95%; margin: auto;">
          Argus enables camera viewpoint control in dynamic environments by unwrapping the generated 360° scene into
          perspective views. This capability allows exploration beyond the initial field of view, enhancing
          immersion in the scene.
        </div>
        <div style="width: 95%; margin: auto;">
          <div id="results-carousel" class="carousel results-carousel">
            <div class="item item-video1">
              <video poster="" id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/camera-control/video47_rotate_30_45.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Clockwise rotation by 30 degrees</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Clockwise rotation by 45 degrees</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video1">
              <video poster="" id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/camera-control/video43_rotate_30_45.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Clockwise rotation by 30 degrees</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Clockwise rotation by 45 degrees</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video2">
              <video poster="" id="video2" autoplay controls muted loop loading="lazy" preload="metadata">
                <!-- Your video file here -->
                <source src="static/videos/camera-control/video33_rotate_30_45.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Clockwise rotation by 30 degrees</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Clockwise rotation by 45 degrees</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video3">
              <video poster="" id="video3" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/camera-control/video20_rotate_30_45.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Clockwise rotation by 30 degrees</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Clockwise rotation by 45 degrees</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video4">
              <video poster="" id="video4" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/camera-control/video42_rotate_-30_-45.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Counterclockwise rotation by 30 degrees</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Counterclockwise rotation by 45 degrees</p>
                  </div>
                </div>
              </h2>
            </div>
            <div class="item item-video6">
              <video poster="" id="video6" autoplay controls muted loop loading="lazy" preload="metadata">
                <!-- Your video file here -->
                <source src="static/videos/camera-control/video44_rotate_-30_-45.mp4" type="video/mp4">
              </video>
              <h2 class="subtitle has-text-centered">
                <div class="columns">
                  <div class="column is-one-third">
                    <p>Input Video</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Counterclockwise rotation by 30 degrees</p>
                  </div>
                  <div class="column is-one-third">
                    <p>Counterclockwise rotation by 45 degrees</p>
                  </div>
                </div>
              </h2>
            </div>
          </div>
        </div>
      </div>
  </section>

  <!-- Relighting -->
  <section class="hero is-small">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Application: Dynamic Environment Map for Object Relighting</h2>
        <div style="width: 95%; margin: auto;">
          <p>
            Argurs enables realistic object relighting by leveraging the generated 360° panorama videos as dynamic
            environment maps. We show the results of rendering a metallic sphere in Blender with the generated videos.
          </p>
          <br>
          <div class="columns">
            <div class="column is-one-third">
              <video poster="" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/environment-relighting/1.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column is-one-third">
              <video poster="" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/environment-relighting/3.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column is-one-third">
              <video poster="" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/environment-relighting/2.mp4" type="video/mp4">
              </video>
            </div>
          </div>
        </div>
      </div>
  </section>

  <section class="hero is-small is-light">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Application: Interactive Visual Question Answering</h2>
        <div style="width: 95%; margin: auto;">
          The panorama video generated by Argus can help visual question answering in dynamic environments.
          By enabling free rotation of the camera, Argus allows for comprehensive spatial understanding by seeing the
          scene from multiple perspectives. This flexibility supports interactive visual question answering, such as
          verifying if a vehicle overlaps with a crosswalk, overcoming the limitations of
          fixed-viewpoint videos. This capability enhances scene comprehension and opens new possibilities for video
          analysis applications.
        </div>
        <br>
        <div class="item">
          <img src="static/images/VQA.png" alt="MY ALT TEXT" />
        </div>
      </div>
    </div>
  </section>

  <section class="hero is-small">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Dataset</h2>
        <div style="width: 95%; margin: auto;">
          <div class="content has-text-justified">
            <div class="columns">
              <p>
                We start with the 360-1M dataset [3], containing approximately 1 million
                videos of varying quality, and systematically filter down to 283,863 high-quality 10-second video
                clips.
                Examples of our dataset are shown below.
              </p>
            </div>
            <br>
            <div class="columns">
              <p style="font-size: 12px;">
                [3] Wallingford et al. <i>From an Image to a Scene: Learning to Imagine the World from a Million
                  360° Videos</i>. In NeurIPS, 2024.
              </p>
            </div>
            <div class="item">
              <img src="static/images/dataset.png" alt="" />
            </div>
          </div>
        </div>
      </div>
  </section>

  <!-- Tracking -->
  <!-- <section class="hero is-small">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Application: Continuous Object Tracking</h2>
        <div style="width: 95%; margin: auto;">
          Free camera rotation within the 360° panorama also allows for continuous object tracking. We apply the object
          detector YOLOv8 to the input perspective video and a perspective video unwrapped from the
          generated panorama. While the detector assigns different labels to a vehicle when it exits
          the input video's perspective reappears in another frame frames, it remains visible in our
          generated panorama, enabling continuous tracking.
        </div>
        <br>
        <div style="width: 95%; margin: auto;">
          <div class="item item-video1">
            <video poster="" id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
              <source src="static/videos/consistent-tracking/1.mp4" type="video/mp4">
            </video>
            <h2 class="subtitle has-text-centered">
              <div class="columns">
                <div class="column is-one-second">
                  <p>Tracking on original video</p>
                </div>
                <div class="column is-one-second">
                  <p>Continuous Tracking (Argus)</p>
                </div>
              </div>
            </h2>
          </div>
        </div>
      </div>
  </section> -->

  <!-- Tracking -->
  <!-- <section class="hero is-small">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Analysis: Multiple Perspective Input Video</h2>
        <div style="width: 90%; margin: auto;">
          <p>
            Although Argus is trained on paired 360° and single perspective videos, we try extending its
            capabilities to handle multiple perspective video inputs. Specifically, we extract two perspective videos
            from each 360° video, reproject them onto a shared equirectangular map, and use this as the model's
            condition. The results are shown below, with the two input regions highlighted in <span
              style="color: rgb(227, 44, 94);">red</span> and <span style="color: rgb(69, 144, 201);">blue</span>. These
            results demonstrate Argus's generalizability to multiple perspective inputs.
          </p>
          <div id="results-carousel" class="carousel results-carousel">
            <div class="item item-video1">
              <video poster="" id="video1" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/multi-patch/1.mp4" type="video/mp4">
              </video>
            </div>
            <div class="item item-video2">
              <video poster="" id="video2" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/multi-patch/2.mp4" type="video/mp4">
              </video>
            </div>
            <div class="item item-video3">
              <video poster="" id="video3" autoplay controls muted loop loading="lazy" preload="metadata">
                <source src="static/videos/multi-patch/3.mp4" type="video/mp4">
              </video>
            </div>
          </div>
        </div>
      </div>
  </section> -->

  <footer class="footer">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template"
                target="_blank">Academic Project Page Template</a> which was adopted from the<a
                href="https://nerfies.github.io" target="_blank"> Nerfies </a>project page.
              <br>
              Licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"
                target="_blank">Creative
                Commons Attribution-ShareAlike 4.0 International License</a>.
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>

</body>

<!-- <div id="debugPanel"></div> -->

<div id="videoModal" class="modal">
  <span id="closeModal" class="close-btn">&times;</span>
  <div id="loader" class="loader"></div>
  <div id="video360Container"></div>
  <div class="video-controls">
    <button id="playPauseBtn" class="control-btn">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M8 5v14l11-7z"></path>
      </svg> Play
    </button>
    <button id="muteBtn" class="control-btn">
      <!-- <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M3 9v6h4l5 5V4L7 9H3z"></path>
        <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"></path>
      </svg> Mute -->
    </button>
    <button id="resetViewBtn" class="control-btn">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path
          d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z">
        </path>
        <path
          d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z">
        </path>
      </svg> Reset View
    </button>
  </div>
</div>

<!-- Replace the existing script with this updated one -->
<script>

  document.addEventListener('DOMContentLoaded', function () {
    const video1 = document.getElementById('estimation1');
    const video2 = document.getElementById('estimation2');
    const video3 = document.getElementById('estimation3');
    const videos = [video1, video2, video3];

    // Counter to track how many videos have loaded enough to play
    let videosReady = 0;

    // Initially pause all videos
    videos.forEach(video => {
      video.pause();
    });

    // Function to check if all videos are ready to play
    function checkAllVideosReady() {
      videosReady++;
      if (videosReady === 3) {
        // Reset all videos to start time
        videos.forEach(video => {
          video.currentTime = 0;
          video.style.opacity = 1; // Make videos visible once all are ready
          video.play();
        });
      }
    }

    // Listen for the canplaythrough event on each video
    videos.forEach(video => {
      // We use canplaythrough instead of loadeddata for better synchronization
      video.addEventListener('canplaythrough', function handler() {
        checkAllVideosReady();
        // Remove the event listener to prevent multiple calls
        video.removeEventListener('canplaythrough', handler);
      });

      // Fallback for videos that might be cached or load very quickly
      if (video.readyState >= 4) {
        checkAllVideosReady();
      }
    });

    // Ensure videos stay in sync during playback
    video1.addEventListener('timeupdate', function () {
      // Only sync if the time difference is significant (more than 0.1 seconds)
      if (Math.abs(video2.currentTime - video1.currentTime) > 0.1) {
        video2.currentTime = video1.currentTime;
      }
      if (Math.abs(video3.currentTime - video1.currentTime) > 0.1) {
        video3.currentTime = video1.currentTime;
      }
    });

    // Handle pause/play to keep videos in sync
    videos.forEach(video => {
      video.addEventListener('pause', function () {
        videos.forEach(v => v.pause());
      });

      video.addEventListener('play', function () {
        videos.forEach(v => {
          v.currentTime = video.currentTime;
          v.play();
        });
      });
    });
  });

  // Debug function
  const debug = {
    panel: document.getElementById('debugPanel'),
    log: function (message) {
      if (this.panel) {
        const time = new Date().toLocaleTimeString();
        this.panel.innerHTML += `<div>[${time}] ${message}</div>`;
        console.log(`[DEBUG] ${message}`);
      }
    },
    error: function (message) {
      if (this.panel) {
        const time = new Date().toLocaleTimeString();
        this.panel.innerHTML += `<div style="color:red">[${time}] ERROR: ${message}</div>`;
        console.error(`[DEBUG ERROR] ${message}`);
      }
    },
    show: function () {
      if (this.panel) this.panel.style.display = 'block';
    },
    hide: function () {
      if (this.panel) this.panel.style.display = 'none';
    },
    clear: function () {
      if (this.panel) this.panel.innerHTML = '';
    }
  };

  // Enable debug in development
  const enableDebug = true;
  if (enableDebug) debug.show();

  // Get DOM elements
  const videoModal = document.getElementById('videoModal');
  const closeModal = document.getElementById('closeModal');
  const video360Container = document.getElementById('video360Container');
  const loader = document.getElementById('loader');
  const playPauseBtn = document.getElementById('playPauseBtn');
  const muteBtn = document.getElementById('muteBtn');
  const resetViewBtn = document.getElementById('resetViewBtn');

  // Three.js variables
  let camera, scene, renderer;
  let video, videoTexture, sphere;
  let isPlaying = false;
  // let isMuted = false;
  let currentVideoItem = null;

  // Find all videos in carousel
  const carouselItems = document.querySelectorAll('#results-carousel .item');

  // Helper function to convert a normal video URL to a 360 video URL
  function getCorresponding360VideoUrl(regularVideoUrl) {
    // Replace the path to point to the 360 version
    // This assumes your 360 videos are in a folder named "360" in the same directory
    return regularVideoUrl.replace(/\/([^\/]+)\.mp4$/, '/$1_360.mp4');
  }

  // Initialize carousel controls and 360 button functionality
  function initializeVideoControls() {
    carouselItems.forEach(item => {
      const videoElement = item.querySelector('video');
      const playBtn = item.querySelector('.play-360-button');

      if (videoElement && playBtn) {
        playBtn.addEventListener('click', function (e) {
          e.stopPropagation(); // Prevent double triggering
          debug.clear();
          debug.log('360 button clicked for video: ' + videoElement.id);

          // Store the current video item for later reference
          currentVideoItem = item;

          // Get source of the regular video
          const regularVideoSrc = videoElement.querySelector('source').src;
          const video360Src = getCorresponding360VideoUrl(regularVideoSrc);

          // Open the 360 modal with the corresponding 360 video
          open360Modal(video360Src);
        });
      }
    });

    debug.log('Video controls initialized');
  }

  // Initialize the 360 video player using Three.js
  function init360Player(video_src_path) {
    debug.log('Initializing 360 player with video: ' + video_src_path);

    try {
      // Clean up previous instance if it exists
      if (renderer) {
        video360Container.removeChild(renderer.domElement);
        renderer.dispose();
        renderer = null;
      }

      if (video) {
        video.pause();
        video.src = '';
        video = null;
      }

      // Create video element
      video = document.createElement('video');
      video.crossOrigin = 'anonymous';
      video.loop = true;
      // video.muted = false;
      video.src = video_src_path;
      video.setAttribute('playsinline', '');

      // Set up camera
      camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      camera.position.set(0, 0, 0.01);

      // Set up scene
      scene = new THREE.Scene();

      // Create video texture
      videoTexture = new THREE.VideoTexture(video);

      // Create sphere geometry (inside-out)
      const geometry = new THREE.SphereGeometry(500, 60, 40);
      geometry.scale(-1, 1, 1); // Flip inside out

      // Create material with video texture
      const material = new THREE.MeshBasicMaterial({ map: videoTexture });

      // Create sphere mesh and add to scene
      sphere = new THREE.Mesh(geometry, material);
      scene.add(sphere);

      // Set up renderer
      renderer = new THREE.WebGLRenderer();
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(window.innerWidth, window.innerHeight);
      video360Container.appendChild(renderer.domElement);

      // Add event listeners for mouse/touch movement
      video360Container.addEventListener('mousedown', onPointerStart);
      video360Container.addEventListener('touchstart', onPointerStart);
      video360Container.addEventListener('mousemove', onPointerMove);
      video360Container.addEventListener('touchmove', onPointerMove);
      video360Container.addEventListener('mouseup', onPointerEnd);
      video360Container.addEventListener('touchend', onPointerEnd);

      // Add resize event listener
      window.addEventListener('resize', onWindowResize);

      debug.log('360 player initialized successfully');
      return true;
    } catch (error) {
      debug.error(`Failed to initialize 360 player: ${error.message}`);
      return false;
    }
  }

  // Mouse/touch control variables
  let isUserInteracting = false;
  let onPointerDownPointerX = 0, onPointerDownPointerY = 0;
  let lon = 180, onPointerDownLon = 180;
  let lat = 0, onPointerDownLat = 0;
  let phi = 0, theta = 0;

  function onPointerStart(event) {
    isUserInteracting = true;

    const clientX = event.clientX || (event.touches && event.touches[0].clientX);
    const clientY = event.clientY || (event.touches && event.touches[0].clientY);

    if (clientX === undefined || clientY === undefined) return;

    onPointerDownPointerX = clientX;
    onPointerDownPointerY = clientY;

    onPointerDownLon = lon;
    onPointerDownLat = lat;

    event.preventDefault();
  }

  function onPointerMove(event) {
    if (!isUserInteracting) return;

    const clientX = event.clientX || (event.touches && event.touches[0].clientX);
    const clientY = event.clientY || (event.touches && event.touches[0].clientY);

    if (clientX === undefined || clientY === undefined) return;

    lon = (onPointerDownPointerX - clientX) * 0.1 + onPointerDownLon;
    lat = (clientY - onPointerDownPointerY) * 0.1 + onPointerDownLat;

    event.preventDefault();
  }

  function onPointerEnd() {
    isUserInteracting = false;
  }

  function onWindowResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  }

  // Animation loop
  function animate() {
    requestAnimationFrame(animate);
    update();
  }

  function update() {
    // Update camera position based on lat/lon
    lat = Math.max(-85, Math.min(85, lat));
    phi = THREE.MathUtils.degToRad(90 - lat);
    theta = THREE.MathUtils.degToRad(lon);

    const x = 500 * Math.sin(phi) * Math.cos(theta);
    const y = 500 * Math.cos(phi);
    const z = 500 * Math.sin(phi) * Math.sin(theta);

    camera.lookAt(x, y, z);

    // Render the scene
    renderer.render(scene, camera);
  }

  // Open the 360 video modal
  function open360Modal(video_src_path) {
    debug.log('Opening 360 modal with video: ' + video_src_path);

    // Pause all regular videos
    document.querySelectorAll('video').forEach(v => v.pause());

    // Show the modal and loader
    videoModal.style.display = 'block';
    loader.style.display = 'block';

    // Initialize the 360 player
    const initSuccess = init360Player(video_src_path);

    if (!initSuccess) {
      debug.error('Failed to open 360 modal due to initialization error');
      close360Modal();
      alert('Sorry, there was an error loading the 360° video. Please try again later.');
      return;
    }

    // Start the animation loop
    animate();

    // Play the 360 video
    video.play()
      .then(() => {
        debug.log('360 video started playing');
        isPlaying = true;
        updatePlayPauseButton();
        loader.style.display = 'none';
      })
      .catch(error => {
        debug.error(`Error playing 360 video: ${error.message}`);

        // Check if it's an autoplay issue and prompt user
        if (error.name === 'NotAllowedError') {
          loader.style.display = 'none';
          alert('Please click the play button to start the 360° video');
        } else {
          close360Modal();
          alert('Sorry, there was an error playing the 360° video. Please try again later.');
        }
      });
  }

  // Close the 360 video modal
  function close360Modal() {
    debug.log('Closing 360 modal');

    // Hide the modal
    videoModal.style.display = 'none';

    // Pause the 360 video
    if (video) video.pause();
    isPlaying = false;

    // Resume the original video if needed
    if (currentVideoItem) {
      const originalVideo = currentVideoItem.querySelector('video');
      if (originalVideo) {
        // Resume the original video
        debug.log('Resuming original video playback');
        originalVideo.play()
          .catch(error => {
            debug.error(`Error resuming original video: ${error.message}`);
          });
      }
    }
  }

  // Toggle play/pause for the 360 video
  function togglePlayPause() {
    if (!video) return;

    if (isPlaying) {
      video.pause();
      isPlaying = false;
    } else {
      video.play()
        .then(() => {
          isPlaying = true;
        })
        .catch(error => {
          debug.error(`Error playing video: ${error.message}`);
        });
    }

    updatePlayPauseButton();
  }

  // Reset the camera view
  function resetView() {
    lon = 180;
    lat = 0;
  }

  // Update the play/pause button state
  function updatePlayPauseButton() {
    playPauseBtn.innerHTML = isPlaying ?
      `<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path>
      </svg> Pause` :
      `<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M8 5v14l11-7z"></path>
      </svg> Play`;
  }

  // Event Listeners
  closeModal.addEventListener('click', function () {
    debug.log('Close button clicked');
    close360Modal();
  });

  playPauseBtn.addEventListener('click', function () {
    debug.log('Play/Pause button clicked');
    togglePlayPause();
  });

  // muteBtn.addEventListener('click', function () {
  //   debug.log('Mute button clicked');
  //   toggleMute();
  // });

  resetViewBtn.addEventListener('click', function () {
    debug.log('Reset view button clicked');
    resetView();
  });

  // Add escape key functionality to close the modal
  document.addEventListener('keydown', function (event) {
    if (event.key === 'Escape' && videoModal.style.display === 'block') {
      debug.log('Escape key pressed');
      close360Modal();
    }
  });

  // Initialize everything when the DOM is fully loaded
  document.addEventListener('DOMContentLoaded', function () {
    initializeVideoControls();
    debug.log('Page fully loaded and initialized');
  });

  // Initial debug messages
  debug.log('Script loaded');
</script>

</html>